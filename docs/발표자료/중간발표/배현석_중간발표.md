# 중간발표 자료 - 광고 생성 서비스

## 담당 파트: 이미지 생성 프롬프트 및 광고 문구 생성
**담당자:** 배현석  
**작업 기간:** 2026년 1월 14일
**모듈 위치:** `src/generation/text_generation/`

---

## 1. 작업 개요

소상공인을 대상으로 한 **광고 생성 서비스** 개발 중 **이미지 생성 프롬프트**와 **광고 문구 생성** 파트를 담당했습니다.

### 주요 목표
- 한글 입력 → SDXL 최적화 영어 프롬프트 자동 변환
- 업종별 특화 템플릿 시스템 구축
- 짧고 임팩트 있는 광고 문구 생성
- 백엔드 연동을 위한 통합 API 제공

### 입출력 구조
```
입력: "카페 신메뉴 딸기라떼 홍보, 따뜻한 느낌"
                ↓
출력: 
  - 광고 문구: "따뜻한 겨울, 새로운 맛"
  - Positive Prompt: "Professional food photography of..."
  - Negative Prompt: "cartoon, illustration..."
  - 감지된 업종: cafe
```

---

## 2. 시스템 아키텍처

```
사용자 입력 (한글)
    ↓
ad_generator.py (통합 진입점)
    ↓
    ├─→ text_generator.py → GPT-4o-mini → 광고 문구 생성
    └─→ prompt_manager.py → GPT-4o-mini → 한글→영어 키워드 추출
            ↓
        config_loader.py (업종 감지 + 템플릿 매칭)
            ↓
        prompt_templates.py (Hybrid Prompting 시스템)
            ↓
        industries.yaml (10개 업종 템플릿)
            ↓
최종 출력 (광고 문구 + 이미지 프롬프트)
```

---

## 3. 핵심 구현 내용

### 3.1 Hybrid Prompting 시스템

**배경:** Civitai 벤치마크 분석 결과, SDXL은 키워드 나열보다 **자연어 + 키워드 혼합** 구조에서 더 좋은 결과를 냅니다.

**프롬프트 구조:**
```python
@dataclass
class PromptStructure:
    # 자연어 구문 (Natural Language)
    subject_phrase: str   # "Professional food photography of strawberry latte"
    setting: str          # "cozy coffee shop atmosphere"
    lighting: str         # "soft natural window light"
    color: str            # "warm pastel pink tones"
    
    # 키워드 (Keywords)
    composition: List[str]  # ["overhead shot", "45-degree angle"]
    style: List[str]        # ["professional food photography"]
    details: List[str]      # ["creamy foam texture"]
    technical: List[str]    # ["85mm lens", "f/1.8 aperture"]
```

**SDXL 최적화 원칙:**

| 항목 | 기존 SD 1.5 | SDXL 최적화 |
|------|------------|------------|
| Quality Tags | "masterpiece, 8k, best quality" | **제거** (역효과) |
| 구조 | 키워드 나열 | 자연어 + 키워드 혼합 |
| Negative | 20-30개 | **5-7개** (최소화) |

### 3.2 GPT-4o 기반 키워드 추출

한글 입력을 분석하여 이미지 생성에 필요한 영어 키워드를 자동 추출합니다.

**입출력 예시:**
| 입력 (한글) | 출력 (영어 키워드) |
|------------|-------------------|
| "카페 신메뉴 딸기라떼, 따뜻한 느낌" | `{"product": "strawberry latte", "theme": "warm", "mood": "cozy"}` |
| "헬스장 근육맨 스쿼트" | `{"person_type": "athletic man", "activity": "barbell squat"}` |
| "빵집 갓 구운 크루아상" | `{"product": "croissant", "state": "freshly baked"}` |

### 3.3 업종별 템플릿 (industries.yaml)

**지원 업종 (10개):**
- 카페, 헬스장, 베이커리, 레스토랑, 세탁소
- 미용실, 네일샵, 꽃집, 옷가게, 일반

**자동 업종 감지:**
```python
# 사용자 입력에서 키워드 분석
"카페 아메리카노" → cafe
"헬스장 운동" → gym
"빵집 크루아상" → bakery
```

### 3.4 광고 문구 생성

GPT-4o-mini를 활용하여 짧고 임팩트 있는 한글 광고 카피를 생성합니다.

**톤 앤 매너:**
- `warm`: 따뜻하고 감성적 → "따뜻한 겨울의 맛"
- `professional`: 전문적, 신뢰감 → "프리미엄 품질의 차이"
- `friendly`: 친근하고 편안 → "우리 동네 단골 맛집"
- `energetic`: 활기차고 역동적 → "오늘도 힘차게!"

---

## 4. 생성 결과 예시

### 카페 (Cafe)
**입력:** "카페 신메뉴 딸기라떼 홍보, 따뜻한 느낌"

**광고 문구:** "따뜻한 겨울, 새로운 맛"

**Positive Prompt:**
```
Professional food photography of strawberry latte on marble table,
cozy coffee shop atmosphere with warm lighting,
soft natural window light streaming from left,
warm pastel pink and beige tones,
overhead shot, creamy foam texture, delicate latte art,
85mm lens, f/1.8 aperture, bokeh background
```

**Negative Prompt:**
```
cartoon, illustration, painting, low quality, artificial, plastic-looking
```

### 헬스장 (Gym)
**입력:** "헬스장 근육맨 스쿼트하는 모습"

**Positive Prompt:**
```
Professional sports photography of athletic man doing barbell squat,
modern gym interior with professional equipment,
dramatic side lighting highlighting muscle definition,
vibrant energetic color palette,
dynamic action shot, defined muscle tone visible,
70-200mm lens, f/2.8 aperture, high shutter speed
```

---

## 5. 기술적 특징

### 중복 제거 알고리즘
프롬프트 조립 시 중복 키워드를 자동 제거하여 효율성을 높입니다.

```python
# 50% 이상 겹치는 구문은 자동 스킵
seen_words = set()
if overlap / len(words_in_part) > 0.5:
    continue  # 중복 제거
```

### 가중치 적용 (선택적)
SDXL은 가중치에 민감하므로 1.1~1.4 범위를 권장합니다.

```python
apply_prompt_weights(prompt, {"strawberry latte": 1.3, "creamy": 1.2})
→ "(strawberry latte:1.3), (creamy:1.2) foam texture..."
```

---

## 6. 사전 조사 및 연구

### Civitai 플랫폼 활용
- 광고/마케팅에 특화된 LoRA 모델 탐색
- 음식/카페 도메인 고품질 생성 사례 수집
- 프롬프트 패턴 분석 (긍정/부정 프롬프트 구조)

### 광고 성과 평가 지표 연구
**정량적 지표:** CTR, Engagement Rate, Conversion Rate  
**정성적 지표:** 브랜드 일치도, 문법 정확성, 가이드라인 준수

### 프롬프트 엔지니어링 기법
- **Chain-of-Thought**: 단계적 추론으로 문구 품질 향상
- **Few-Shot Learning**: 우수 사례 3-5개 포함하여 스타일 일관성 확보
- **System Prompt 최적화**: 역할 정의, 제약 조건 명시

---

## 7. 테스트 결과

### 키워드 추출 정확도
| 입력 | 추출 결과 | 상태 |
|------|----------|------|
| "딸기라떼 신메뉴" | `{"product": "strawberry latte"}` | Pass |
| "근육맨 스쿼트" | `{"person_type": "athletic man", "activity": "barbell squat"}` | Pass |
| "갓 구운 크루아상" | `{"product": "croissant", "state": "freshly baked"}` | Pass |

### 업종 감지 정확도
| 입력 | 예상 업종 | 감지 결과 | 상태 |
|------|----------|----------|------|
| "카페 아메리카노" | cafe | cafe | Pass |
| "헬스장 운동" | gym | gym | Pass |
| "빵집 크루아상" | bakery | bakery | Pass |

---

## 8. 다음 단계: RAG 기반 상담 챗봇

### 목표
광고 생성 전 소상공인의 고민을 해소하고, **성공 사례 기반 맞춤형 조언**을 제공하는 상담 챗봇 개발

### RAG 시스템 설계 방향

**1. 데이터 수집**
- 유사 업종(카페/음식점)의 성공 광고 사례 크롤링
- 인스타그램, 네이버 플레이스, 배달앱 인기 콘텐츠 수집
- 메타데이터: 업종, 플랫폼, 성과 지표, 스타일

**2. 벡터 DB 구축**
- 수집된 사례를 임베딩하여 벡터 DB 저장
- 업종/플랫폼별 필터링 가능한 구조 설계

**3. 검색 최적화**
- 사용자 질문과 유사한 성공 사례 검색
- 입찰메이트 프로젝트에서 쌓은 RAG 경험 활용

**4. 챗봇 통합**
- 검색된 사례를 기반으로 맞춤형 상담 제공
- 워크플로우 자연스러운 전환: 상담 → 생성

### 검토 중인 기술 선택지

**임베딩 모델:** BGE-M3, OpenAI Embeddings, 기타 한국어 특화 모델 비교 예정  
**생성 모델:** OpenAI GPT vs 오픈소스 LLM (성능/비용/응답속도 평가 중)  
**벡터 DB:** FAISS, Pinecone, ChromaDB 중 선정 예정

### 기대 효과
- 단순 생성 → 근거 기반 추천으로 신뢰도 향상
- 소상공인의 심리적 진입장벽 감소
- 생성 결과의 실용성 및 효과성 증대

---

**작성일:** 2026년 1월 14일  
**발표일:** 2026년 1월 15일 10:00
